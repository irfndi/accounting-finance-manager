import{j as s,B as S}from"./button.CDive8EV.js";import{r as a}from"./index.D4lIrffr.js";import{C as u}from"./card.Dfef4M5o.js";function k({className:p=""}){const[r,f]=a.useState(""),[o,d]=a.useState([]),[n,l]=a.useState(!1),[h,i]=a.useState(null),[c,m]=a.useState(null),x=a.useCallback(async()=>{if(!r.trim()){i("Please enter a search query");return}l(!0),i(null),d([]),m(null);try{const t=await(await fetch("/api/vectorize/search",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")||""}`},body:JSON.stringify({query:r.trim(),topK:10,threshold:.7})})).json();if(!t.success)throw new Error(t.error||"Search failed");t.data&&(d(t.data.results||[]),m({totalMatches:t.data.totalMatches||0,processingTime:t.data.processingTime||0}))}catch(e){i(e instanceof Error?e.message:"Search failed")}finally{l(!1)}},[r]),g=e=>{e.key==="Enter"&&!n&&x()},y=e=>(e*100).toFixed(1),j=e=>new Date(e).toLocaleDateString(),N=(e,t=200)=>e.length<=t?e:e.substring(0,t)+"...";return s.jsx("div",{className:`document-search ${p}`,children:s.jsx(u,{className:"p-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Document Search"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Search through your documents using natural language queries"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:r,onChange:e=>f(e.target.value),onKeyDown:g,placeholder:"Search for documents... (e.g., 'invoices from last month', 'tax documents')",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:n}),s.jsx(S,{onClick:x,disabled:n||!r.trim(),className:"px-6",children:n?"Searching...":"Search"})]}),h&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:h}),c&&s.jsxs("div",{className:"text-sm text-gray-600",children:["Found ",c.totalMatches," results in ",c.processingTime,"ms"]}),o.length>0&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Search Results"}),o.map(e=>s.jsx(u,{className:"p-4 hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:e.fileName||e.id}),e.mimeType&&s.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:e.mimeType})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-sm font-medium text-green-600",children:[y(e.similarity),"% match"]}),e.uploadedAt&&s.jsx("div",{className:"text-xs text-gray-500",children:j(e.uploadedAt)})]})]}),e.matchedText&&s.jsx("p",{className:"text-gray-700 text-sm leading-relaxed",children:N(e.matchedText)}),e.chunkInfo&&s.jsxs("div",{className:"text-xs text-gray-500",children:["Chunk ",e.chunkInfo.chunkIndex+1," of ",e.chunkInfo.totalChunks]})]})},e.id))]}),!n&&o.length===0&&c&&s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx("p",{children:"No documents found matching your search."}),s.jsx("p",{className:"text-sm mt-1",children:"Try using different keywords or phrases."})]})]})})})}export{k as default};
